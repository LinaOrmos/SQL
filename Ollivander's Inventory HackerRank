SELECT MIN(W.ID), P.AGE, MIN(W.COINS_NEEDED), W.POWER FROM WANDS W LEFT JOIN WANDS_PROPERTY P ON P.CODE=W.CODE WHERE P.IS_EVIL=0 AND W.COINS_NEEDED=(SELECT MIN(COINS_NEEDED) FROM WANDS WHERE CODE=W.CODE AND POWER=W.POWER) GROUP BY P.AGE,W.POWER ORDER BY W.POWER DESC,P.AGE DESC
